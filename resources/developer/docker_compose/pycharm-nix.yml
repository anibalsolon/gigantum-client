version: '2'
services:
  labmanager:
    image: gigantum/labmanager-dev:latest
    entrypoint: /usr/local/bin/entrypoint.sh
    command: /bin/bash
    ports:
      - "10000:10000"
      - "10001:10001"
      - "10002:10002"
    expose:
      - "6379"
    volumes:
      - {% WORKING_DIR %}:/mnt/gigantum:cached
      - /var/run/docker.sock:/var/run/docker.sock
      - labmanager_share_vol:/mnt/share
      - {% HELPER_SCRIPT %}:/opt/setup.sh
    environment:
      - LOCAL_USER_ID={% USER_ID %}
      - HOST_WORK_DIR={% WORKING_DIR %}
      - PYCHARM-DEV=1

  redis-commander:
    container_name: redis-commander
    hostname: redis-commander
    image: rediscommander/redis-commander:latest
    restart: always
    environment:
      - REDIS_HOSTS=local:labmanager:6379
    ports:
      - "8081:8081"

volumes:
  labmanager_share_vol:
    external: true
